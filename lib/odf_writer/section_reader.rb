module ODFWriter
  
  ########################################################################################
  #
  # SectionReader: find all sections and set name
  #
  ########################################################################################
  class SectionReader
    
    attr_accessor :name
    
    ######################################################################################
    #
    # initialize
    #
    ######################################################################################
    def initialize(opts)
      @name = opts[:name]
    end #def
    
    ######################################################################################
    #
    # get_sections
    #
    ######################################################################################
    def get_sections( doc )
      get_nodes( doc ).keys
    end #def
    
    ######################################################################################
    #
    # get_nodes
    #
    ######################################################################################
    def get_nodes( doc )
      doc.xpath(".//text:section").map{|node| [node.attr("text:name"), node] }.to_h
    end #def
    
  end #class
end #module
