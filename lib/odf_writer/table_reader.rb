module ODFWriter
  
  ########################################################################################
  #
  # TableReader: find all tables and set name
  #
  ########################################################################################
  class TableReader
    
    attr_accessor :name
    
    ######################################################################################
    #
    # initialize
    #
    ######################################################################################
    def initialize(opts)
      @name = opts[:name]
    end #def
    
    ######################################################################################
    #
    # tables
    #
    ######################################################################################
    def tables( doc )
      nodes( doc ).keys
    end #def
    
    ######################################################################################
    #
    # nodes
    #
    ######################################################################################
    def nodes( doc )
      doc.xpath(".//table:table").map{|node| [node.attr("table:name"), node] }.to_h
    end #def
  end #class
  
end #module
