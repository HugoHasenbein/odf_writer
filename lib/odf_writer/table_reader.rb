module ODFWriter
  
  ########################################################################################
  #
  # TableReader: find all tables and set name
  #
  ########################################################################################
  class TableReader
    
    attr_accessor :name
    
    ######################################################################################
    #
    # initialize
    #
    ######################################################################################
    def initialize(opts)
      @name = opts[:name]
    end #def
    
    ######################################################################################
    #
    # get_sections
    #
    ######################################################################################
    def get_tables( doc )
      get_nodes( doc ).keys
    end #def
    
    ######################################################################################
    #
    # get_sections
    #
    ######################################################################################
    def get_nodes( doc )
      doc.xpath(".//table:table").map{|node| [node.attr("table:name"), node] }.to_h
    end #def
  end #class
  
end #module
